<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Snack Packz — Spin Select</title>
  <meta name="theme-color" content="#070812"/>

  <style>
    :root{
      --txt:#EEF3FF;
      --mut:rgba(238,243,255,.72);
      --line:rgba(255,255,255,.12);
      --glass:rgba(12,16,32,.46);
      --glass2:rgba(12,16,32,.28);
      --shadow: 0 24px 110px rgba(0,0,0,.60);
      --r:22px;

      --accent:#A5F0FF;
      --accent2:#B7A8FF;

      --bg0:#050612;
      --bg1:#06081A;

      --hudW:min(36vw, 520px);
      --stageW:min(1050px, 100%);
      --sphereSize:min(52vmin, 520px);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--txt);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1400px 900px at 20% 15%, rgba(167,120,255,.14), transparent 60%),
        radial-gradient(1200px 900px at 78% 18%, rgba(72,220,255,.12), transparent 60%),
        radial-gradient(900px 700px at 50% 90%, rgba(120,255,209,.08), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow:hidden;
    }
    a{ color:inherit; text-decoration:none; }
    button{ font:inherit; }
    .hide{ opacity:0; pointer-events:none; transform: translateY(8px); }

    /* ===== NAV ===== */
    .nav{
      position:fixed; left:0; right:0; top:0;
      z-index:50;
      padding: 14px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.08));
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .brand{ display:flex; align-items:center; gap:12px; min-width:0; }
    .logo{
      width:40px;height:40px;border-radius:14px;
      background:
        radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(18px 18px at 70% 65%, rgba(165,240,255,.22), transparent 65%),
        linear-gradient(135deg, rgba(165,240,255,.25), rgba(183,168,255,.20));
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 14px 34px rgba(0,0,0,.40);
      flex:0 0 auto;
    }
    .brandText h1{
      margin:0;
      font-size:15px;
      font-weight:950;
      letter-spacing:.5px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brandText p{
      margin:4px 0 0;
      font-size:12px;
      color:rgba(238,243,255,.70);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .navLinks{
      display:flex;
      gap:18px;
      align-items:center;
      color: rgba(238,243,255,.72);
      font-size:12px;
      letter-spacing:.2px;
    }
    .navLinks a{ padding:8px 10px; border-radius:999px; transition: background .12s ease; }
    .navLinks a:hover{ background: rgba(255,255,255,.06); }

    .btn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: rgba(238,243,255,.92);
      border-radius: 999px;
      padding: 9px 12px;
      font-size: 12px;
      letter-spacing:.2px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      cursor:pointer;
      white-space:nowrap;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(0,0,0,.26); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .dot{
      width:7px;height:7px;border-radius:50%;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 4px rgba(165,240,255,.10);
    }

    /* ===== LAYOUT ===== */
    .scene{
      position:fixed;
      inset:0;
      padding-top: 74px;
      z-index:10;
      display:grid;
      grid-template-columns: 1fr var(--hudW);
      gap: clamp(14px, 2.4vw, 26px);
      align-items:stretch;
    }
    @media (max-width: 980px){
      body{ overflow:auto; }
      .scene{
        position:relative;
        padding-top: 78px;
        grid-template-columns: 1fr;
      }
      .navLinks{ display:none; }
    }

    /* ===== HERO / CENTRE ===== */
    .left{
      padding: clamp(12px, 2vw, 18px);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .heroCard{
      width: var(--stageW);
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      min-height: 72vh;
    }
    .heroCard:before{
      content:"";
      position:absolute; inset:-1px;
      background:
        radial-gradient(800px 420px at 50% 22%, rgba(165,240,255,.12), transparent 62%),
        radial-gradient(900px 600px at 60% 70%, rgba(183,168,255,.10), transparent 62%),
        radial-gradient(900px 700px at 40% 110%, rgba(120,255,209,.07), transparent 62%);
      opacity:.95;
      pointer-events:none;
    }

    .heroInner{
      position:relative;
      z-index:2;
      height:100%;
      padding: clamp(18px, 2.4vw, 26px);
      display:grid;
      grid-template-rows: auto 1fr auto;
      gap: 18px;
    }

    /* big headline area that fades when sphere engaged */
    .headline{
      display:grid;
      gap:10px;
      justify-items:center;
      text-align:center;
      transition: opacity 260ms ease, transform 260ms ease, filter 260ms ease;
    }
    .kicker{
      display:inline-flex;
      align-items:center;
      gap:10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius:999px;
      padding: 10px 14px;
      font-size: 12px;
      color: rgba(238,243,255,.78);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .kicker .dot{ width:8px;height:8px; }
    .headline h2{
      margin:0;
      font-size: clamp(34px, 4.6vw, 56px);
      line-height:1.03;
      font-weight: 980;
      letter-spacing: -0.8px;
      text-shadow: 0 30px 70px rgba(0,0,0,.55);
      max-width: 18ch;
    }
    .headline p{
      margin:0;
      color: rgba(238,243,255,.74);
      font-size: 13px;
      line-height: 1.45;
      max-width: 62ch;
    }

    .ctaRow{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top: 6px;
    }
    .ctaPrimary{
      padding: 11px 14px;
      font-weight: 950;
      border-color: rgba(165,240,255,.18);
    }

    /* centre stage */
    .centreStage{
      position:relative;
      display:grid;
      place-items:center;
      min-height: 420px;
    }

    /* 3D sphere */
    .sphereWrap{
      width: var(--sphereSize);
      height: var(--sphereSize);
      position:relative;
      display:grid;
      place-items:center;
      touch-action:none;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }

    /* background particle canvas */
    canvas#fx{
      position:absolute;
      inset:-30%;
      width:160%;
      height:160%;
      z-index:0;
      opacity:.85;
      pointer-events:none;
      filter: blur(0.2px);
    }

    .sphere{
      position:relative;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      z-index:2;

      background:
        radial-gradient(circle at 36% 30%, rgba(255,255,255,.18), rgba(255,255,255,0) 34%),
        radial-gradient(circle at 60% 46%, rgba(165,240,255,.10), rgba(165,240,255,0) 46%),
        radial-gradient(circle at 50% 62%, rgba(183,168,255,.08), rgba(183,168,255,0) 55%),
        radial-gradient(circle at 50% 55%, rgba(0,0,0,.08), rgba(0,0,0,.55)),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.30));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow:
        0 40px 130px rgba(0,0,0,.65),
        inset 0 0 0 1px rgba(255,255,255,.07);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transform: translateZ(0);
    }

    .sphere:before{
      content:"";
      position:absolute;
      inset:-14%;
      border-radius:50%;
      background:
        radial-gradient(circle at 55% 50%, rgba(255,255,255,.06), transparent 60%),
        radial-gradient(circle at 40% 42%, rgba(165,240,255,.14), transparent 62%),
        radial-gradient(circle at 60% 58%, rgba(183,168,255,.12), transparent 62%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
      mix-blend-mode: screen;
    }

    /* subtle vertical beam like your screenshot */
    .beam{
      position:absolute;
      z-index:1;
      width: 24%;
      height: 140%;
      top: -20%;
      left: 38%;
      background: linear-gradient(180deg, rgba(165,240,255,0), rgba(165,240,255,.18), rgba(183,168,255,.14), rgba(0,0,0,0));
      filter: blur(10px);
      opacity:.75;
      pointer-events:none;
    }

    /* ring / wheel */
    .ring{
      position:absolute;
      inset:-16%;
      border-radius:50%;
      z-index:3;
      pointer-events:none;
    }
    .ring:before{
      content:"";
      position:absolute;
      inset: 6%;
      border-radius:50%;
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.05);
      background:
        radial-gradient(circle at 50% 50%, rgba(255,255,255,.03), rgba(0,0,0,0) 55%),
        radial-gradient(circle at 50% 50%, rgba(0,0,0,.10), rgba(0,0,0,0) 62%);
    }

    /* vibe options (hidden until engaged) */
    .options{
      position:absolute;
      inset:-18%;
      border-radius:50%;
      z-index:4;
      pointer-events:auto;
      opacity:0;
      transform: scale(.985);
      filter: blur(.2px);
      transition: opacity 240ms ease, transform 240ms ease;
    }
    .engaged .options{
      opacity:1;
      transform: scale(1);
    }

    .opt{
      position:absolute;
      left:50%; top:50%;
      height:36px;
      transform-origin: 0% 50%;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.24);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      display:flex;
      align-items:center;
      gap:10px;
      padding: 0 12px;
      cursor:pointer;
      box-shadow: 0 18px 70px rgba(0,0,0,.55);
      transition: border-color .12s ease, background .12s ease, box-shadow .12s ease, transform .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      pointer-events:auto;
      white-space:nowrap;
    }
    .opt:hover{
      border-color: rgba(165,240,255,.28);
      background: rgba(0,0,0,.30);
      box-shadow: 0 18px 80px rgba(0,0,0,.70);
    }
    .opt.active{
      border-color: rgba(165,240,255,.36);
      background: rgba(0,0,0,.32);
    }
    .oDot{
      width:10px;height:10px;border-radius:50%;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 6px rgba(165,240,255,.10);
      flex:0 0 auto;
    }
    .oTxt{ font-weight:950; font-size:12px; letter-spacing:.55px; text-transform:uppercase; }
    .oSub{ margin-left:auto; font-size:11px; color:rgba(238,243,255,.66); letter-spacing:.2px; text-transform:uppercase; }

    /* sphere hint */
    .sphereHint{
      position:absolute;
      bottom: -44px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      color: rgba(238,243,255,.62);
      text-align:center;
      line-height:1.25;
      max-width: 46ch;
      pointer-events:none;
      opacity:.95;
    }

    /* headline hides when engaged */
    .engaged .headline{
      opacity:0;
      transform: translateY(-10px);
      filter: blur(2px);
      pointer-events:none;
    }

    /* bottom stats tiles */
    .stats{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 4px;
    }
    @media (max-width: 920px){
      .stats{ grid-template-columns: 1fr; }
    }
    .stat{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 14px 14px;
    }
    .stat .n{ font-size: 26px; font-weight: 980; letter-spacing:-.3px; }
    .stat .t{ margin-top:6px; font-size: 12px; color: rgba(238,243,255,.70); }

    /* ===== RIGHT PREVIEW ===== */
    .hud{
      padding: clamp(12px, 2vw, 16px);
      border-left:1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:stretch;
    }
    @media (max-width: 980px){ .hud{ border-left:none; } }

    .hudCard{
      width:100%;
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      position:relative;
      min-height: 420px;
    }

    .hudMedia{ position:absolute; inset:0; z-index:2; }
    .hudMedia img, .hudMedia video{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit: cover;
      transform: scale(1.02);
      filter: contrast(1.06) saturate(1.03);
    }
    .hudMedia img{ opacity:1; transition: opacity 220ms ease; }
    .hudMedia video{ opacity:0; transition: opacity 320ms ease; }
    .hudMedia.ready video{ opacity:1; }
    .hudMedia.ready img{ opacity:0; }

    .hudShade{
      position:absolute; inset:0; z-index:3;
      background:
        radial-gradient(700px 380px at 20% 10%, rgba(0,0,0,.12), transparent 60%),
        radial-gradient(800px 520px at 70% 35%, rgba(0,0,0,.26), transparent 65%),
        linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.72));
      pointer-events:none;
    }
    .hudTop{
      position:relative; z-index:5;
      padding:16px 16px 0;
      display:flex; justify-content:space-between; gap:12px; align-items:flex-start;
    }
    .hudTitle h3{
      margin:0;
      font-size:18px;
      font-weight:950;
      letter-spacing:.5px;
      text-shadow: 0 18px 50px rgba(0,0,0,.65);
    }
    .hudTitle p{
      margin:6px 0 0;
      font-size:12.5px;
      color:rgba(238,243,255,.78);
      line-height:1.35;
      text-shadow: 0 18px 50px rgba(0,0,0,.65);
      max-width:46ch;
    }
    .enter{
      border-radius: 16px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.24);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      font-size: 12px;
      font-weight: 950;
      letter-spacing:.25px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      white-space:nowrap;
    }
    .spark{
      width:18px;height:18px;border-radius:10px;
      background: linear-gradient(180deg, rgba(165,240,255,.90), rgba(183,168,255,.82));
      box-shadow: 0 0 0 6px rgba(165,240,255,.10);
      border:1px solid rgba(255,255,255,.12);
    }

    .hudBottom{
      position:absolute; left:0; right:0; bottom:0;
      z-index:6;
      padding:14px 16px 16px;
      display:flex; justify-content:space-between; gap:12px; align-items:flex-end;
    }
    .hudStat{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      border-radius: 16px;
      padding: 10px 12px;
      max-width: 62%;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .hudStat .k{ font-size:11px; color:rgba(238,243,255,.70); }
    .hudStat .v{ margin-top:5px; font-size:12.5px; font-weight:950; }
    .hudTip{
      text-align:right;
      font-size:11px;
      color:rgba(238,243,255,.70);
      line-height:1.25;
      text-shadow: 0 18px 50px rgba(0,0,0,.65);
    }

    /* small helper */
    .mobileOnly{ display:none; }
    @media (hover:none){
      .mobileOnly{ display:block; }
    }
  </style>
</head>

<body>
  <div class="nav">
    <div class="brand">
      <div class="logo"></div>
      <div class="brandText">
        <h1>Snack Packz</h1>
        <p>Spin the wheel. Pick your vibe. Order fast.</p>
      </div>
    </div>

    <div class="navLinks">
      <a href="#" onclick="return false;">About</a>
      <a href="#" onclick="return false;">Services</a>
      <a href="#" onclick="return false;">Pricing</a>
      <a href="#" onclick="return false;">Resources</a>
      <a href="#" onclick="return false;">Blog</a>
    </div>

    <div style="display:flex; gap:10px; align-items:center;">
      <div class="btn"><span class="dot"></span> Drag • Scroll • Snap</div>
      <a class="btn" id="waTop" href="#" rel="noopener">WhatsApp</a>
    </div>
  </div>

  <div class="scene" id="scene">
    <!-- LEFT HERO -->
    <div class="left">
      <div class="heroCard" id="heroCard">
        <div class="heroInner">

          <div class="headline" id="headline">
            <div class="kicker"><span class="dot"></span> Spin-to-select • Premium previews • Fast order</div>
            <h2>Redefining Snack Packs with a 3D Spin Selector.</h2>
            <p>Hover the sphere to reveal the vibes. Spin to choose. Preview loads clean (image → video). Then enter and order.</p>
            <div class="ctaRow">
              <a class="btn ctaPrimary" href="#" onclick="document.getElementById('sphereWrap').scrollIntoView({behavior:'smooth'}); return false;">Discover</a>
              <a class="btn" id="waCta" href="#" rel="noopener">Order on WhatsApp</a>
            </div>
            <div class="mobileOnly" style="margin-top:10px; font-size:11px; color:rgba(238,243,255,.62);">
              Mobile: tap the sphere once to reveal options.
            </div>
          </div>

          <div class="centreStage">
            <div class="beam" aria-hidden="true"></div>

            <div class="sphereWrap" id="sphereWrap" aria-label="3D selector">
              <canvas id="fx" width="900" height="900" aria-hidden="true"></canvas>

              <div class="sphere" id="sphere" role="button" aria-label="Reveal vibes"></div>
              <div class="ring" aria-hidden="true"></div>

              <div class="options" id="options" aria-label="Vibe options"></div>

              <div class="sphereHint" id="sphereHint">
                Hover the sphere to reveal options. Drag to spin. Scroll to flick.
              </div>
            </div>
          </div>

          <div class="stats">
            <div class="stat"><div class="n">Fast</div><div class="t">No slow rotation. Snap selection instantly.</div></div>
            <div class="stat"><div class="n">Premium</div><div class="t">Image loads instantly → video fades in when ready.</div></div>
            <div class="stat"><div class="n">Simple</div><div class="t">Pick a vibe. Enter. WhatsApp order in one tap.</div></div>
          </div>

        </div>
      </div>
    </div>

    <!-- RIGHT PREVIEW -->
    <div class="hud">
      <div class="hudCard">
        <div class="hudMedia" id="hudMedia" aria-hidden="true">
          <img id="hudImg" src="assets/gym.jpg" alt=""/>
          <video id="hudVid" muted playsinline loop preload="metadata"></video>
        </div>
        <div class="hudShade" aria-hidden="true"></div>

        <div class="hudTop">
          <div class="hudTitle">
            <h3 id="hudTitle">GYM</h3>
            <p id="hudDesc">High focus. Clean fuel. No distractions.</p>
          </div>
          <a class="enter" id="enterBtn" href="gym.html">
            <span class="spark" aria-hidden="true"></span>
            Enter
          </a>
        </div>

        <div class="hudBottom">
          <div class="hudStat">
            <div class="k">Preview</div>
            <div class="v" id="hudMeta">Image → Video</div>
          </div>
          <div class="hudTip">
            Hover sphere to reveal<br/>Drag to spin<br/>Tap twice on mobile
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Config =====
    const WHATSAPP_NUMBER = "447483849357"; // wa.me format (no +)

    const vibes = [
      { key:"gym",     label:"GYM",     sub:"FOCUS", page:"gym.html",     img:"assets/gym.jpg",     vid:"assets/gym.mp4",     desc:"High focus. Clean fuel. No distractions." },
      { key:"lockin",  label:"LOCK-IN", sub:"GRIND", page:"lock-in.html", img:"assets/lockin.jpg",  vid:"assets/lockin.mp4",  desc:"Tunnel vision mode. Phone down. Get it done." },
      { key:"work",    label:"WORK",    sub:"DAY",   page:"work.html",    img:"assets/work.jpg",    vid:"assets/work.mp4",    desc:"Clean energy. Smooth day. No crash." },
      { key:"gaming",  label:"GAMING",  sub:"NIGHT", page:"gaming.html",  img:"assets/gaming.jpg",  vid:"assets/gaming.mp4",  desc:"Locked in. Fast hands. Zero tilt." },
      { key:"mystery", label:"MYSTERY", sub:"DROP",  page:"mystery.html", img:"assets/mystery.jpg", vid:"assets/mystery.mp4", desc:"Random pull. Premium chaos (in a good way)." },
      { key:"fresh",   label:"FRESH",   sub:"CLEAN", page:"fresh.html",   img:"assets/fresh.jpg",   vid:"assets/fresh.mp4",   desc:"Light, clean, refreshing. Reset the day." },
    ];

    const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));

    const wa = (text)=>`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(text)}`;
    document.getElementById("waTop").href = wa("Hi Snack Packz — I want to place an order.");
    document.getElementById("waCta").href = wa("Hi Snack Packz — I want to place an order.");

    // ===== DOM =====
    const heroCard  = document.getElementById("heroCard");
    const headline  = document.getElementById("headline");
    const sphereWrap= document.getElementById("sphereWrap");
    const sphere    = document.getElementById("sphere");
    const optionsEl = document.getElementById("options");

    const hudMedia = document.getElementById("hudMedia");
    const hudImg   = document.getElementById("hudImg");
    const hudVid   = document.getElementById("hudVid");
    const hudTitle = document.getElementById("hudTitle");
    const hudDesc  = document.getElementById("hudDesc");
    const hudMeta  = document.getElementById("hudMeta");
    const enterBtn = document.getElementById("enterBtn");

    // ===== Premium preview (image instantly → video fades when ready) =====
    let videoToken = 0;
    function loadPreview(v){
      hudTitle.textContent = v.label;
      hudDesc.textContent  = v.desc;
      enterBtn.href = v.page;

      hudMedia.classList.remove("ready");
      hudMeta.textContent = "Image → Video";
      hudImg.src = v.img;

      const t = ++videoToken;
      try{ hudVid.pause(); }catch(e){}
      hudVid.removeAttribute("src");
      hudVid.load();
      hudVid.src = v.vid;

      const onReady = ()=>{
        if (t !== videoToken) return;
        hudMedia.classList.add("ready");
        hudMeta.textContent = "Video ready";
        try{ hudVid.play().catch(()=>{}); }catch(e){}
      };
      const onErr = ()=>{
        if (t !== videoToken) return;
        hudMedia.classList.remove("ready");
        hudMeta.textContent = "Video unavailable (image only)";
      };

      hudVid.addEventListener("loadeddata", onReady, {once:true});
      hudVid.addEventListener("canplaythrough", onReady, {once:true});
      hudVid.addEventListener("error", onErr, {once:true});
      hudVid.load();
    }

    // ===== Options ring build =====
    const N = vibes.length;
    function buildOptions(){
      optionsEl.innerHTML = "";
      const radiusPct = 54; // distance from centre
      for(let i=0;i<N;i++){
        const opt = document.createElement("div");
        opt.className = "opt";
        opt.dataset.index = String(i);
        opt.style.width = (vibes[i].label.length > 6 ? 158 : 138) + "px";

        const deg = (i*(360/N)) - 90;
        opt.style.transform = `rotate(${deg}deg) translateX(${radiusPct}%)`;

        opt.innerHTML = `
          <span class="oDot" aria-hidden="true"></span>
          <span class="oTxt">${vibes[i].label}</span>
          <span class="oSub">${vibes[i].sub}</span>
        `;

        opt.addEventListener("mouseenter", ()=>{
          if (window.matchMedia("(hover:hover)").matches){
            setActive(i, false);
          }
        });

        opt.addEventListener("click", (e)=>{
          e.preventDefault();
          const idx = Number(opt.dataset.index);

          // mobile: tap once preview, second tap enter
          if (window.matchMedia("(hover:none)").matches){
            if (activeIndex === idx && opt.classList.contains("active")){
              window.location.href = vibes[idx].page;
              return;
            }
            setActive(idx, true);
            return;
          }

          setActive(idx, true);
        }, {passive:false});

        optionsEl.appendChild(opt);
      }
      updateActiveClass();
    }

    function updateActiveClass(){
      optionsEl.querySelectorAll(".opt").forEach(el=>el.classList.remove("active"));
      const el = optionsEl.querySelector(`.opt[data-index="${activeIndex}"]`);
      if (el) el.classList.add("active");
    }

    // ===== Interaction: ring spin =====
    const step = 360/N;

    let rot = 0;     // degrees
    let vel = 0;     // deg/sec
    let dragging = false;
    let pointerId = null;
    let lastAng = 0;
    let lastT = 0;

    let activeIndex = 0;
    let engaged = false; // sphere reveal mode

    const normDeg = d => ((d%360)+360)%360;

    function nearestIndex(){
      const r = normDeg(rot);
      let i = Math.round((-r) / step);
      i = ((i%N)+N)%N;
      return i;
    }

    function snapToIndex(i){
      const target = -i * step;
      let diff = target - rot;
      diff = ((diff + 540) % 360) - 180;
      rot += diff;
      vel = 0;
    }

    function setActive(i, snap=true){
      activeIndex = i;
      updateActiveClass();
      loadPreview(vibes[i]);
      if (snap) snapToIndex(i);
    }

    function angleFromEvent(e){
      const rect = sphereWrap.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      const dx = e.clientX - cx;
      const dy = e.clientY - cy;
      return Math.atan2(dy, dx) * 180 / Math.PI;
    }

    function applyRotation(){
      optionsEl.style.transform = `rotate(${rot}deg)`;
    }

    function onDown(e){
      if (!engaged) return;
      dragging = true;
      pointerId = e.pointerId;
      sphereWrap.setPointerCapture?.(pointerId);
      lastAng = angleFromEvent(e);
      lastT = performance.now();
    }

    function onMove(e){
      if (!dragging || e.pointerId !== pointerId) return;

      const a = angleFromEvent(e);
      let da = a - lastAng;
      if (da > 180) da -= 360;
      if (da < -180) da += 360;

      rot += da;

      const now = performance.now();
      const dt = Math.max(1, (now - lastT)) / 1000;
      const v = da / dt;
      vel = vel*0.78 + v*0.22;

      lastAng = a;
      lastT = now;

      applyRotation();

      const idx = nearestIndex();
      if (idx !== activeIndex){
        activeIndex = idx;
        updateActiveClass();
        loadPreview(vibes[idx]);
      }
    }

    function onUp(e){
      if (!dragging || e.pointerId !== pointerId) return;
      dragging = false;
      pointerId = null;
      setTimeout(()=> setActive(nearestIndex(), true), 70);
    }

    function onWheel(e){
      if (!engaged) return;
      e.preventDefault();
      const delta = e.deltaY || 0;
      const add = clamp(delta * 0.16, -35, 35);
      rot += add;
      vel += add * 6;
      applyRotation();

      const idx = nearestIndex();
      if (idx !== activeIndex){
        activeIndex = idx;
        updateActiveClass();
        loadPreview(vibes[idx]);
      }

      clearTimeout(onWheel._t);
      onWheel._t = setTimeout(()=> setActive(nearestIndex(), true), 110);
    }

    function loop(){
      if (engaged && !dragging){
        rot += vel * (1/60);
        vel *= 0.94;

        if (Math.abs(vel) < 18){
          const idx = nearestIndex();
          const target = -idx * step;
          let diff = target - rot;
          diff = ((diff + 540) % 360) - 180;
          rot += diff * 0.10;

          if (idx !== activeIndex){
            activeIndex = idx;
            updateActiveClass();
            loadPreview(vibes[idx]);
          }
        }
        applyRotation();
      }
      requestAnimationFrame(loop);
    }

    // ===== Engage behaviour =====
    function setEngaged(on){
      engaged = on;
      heroCard.classList.toggle("engaged", engaged);
    }

    // desktop hover to reveal
    sphereWrap.addEventListener("mouseenter", ()=>{
      if (window.matchMedia("(hover:hover)").matches) setEngaged(true);
    });
    heroCard.addEventListener("mouseleave", ()=>{
      if (window.matchMedia("(hover:hover)").matches) setEngaged(false);
    });

    // mobile tap to reveal
    sphere.addEventListener("click", ()=>{
      if (window.matchMedia("(hover:none)").matches){
        setEngaged(!engaged);
      }
    });

    // pointer controls
    sphereWrap.addEventListener("pointerdown", onDown, {passive:true});
    window.addEventListener("pointermove", onMove, {passive:true});
    window.addEventListener("pointerup", onUp, {passive:true});
    sphereWrap.addEventListener("wheel", onWheel, {passive:false});

    // ===== FX canvas (particles + subtle parallax glow) =====
    const fx = document.getElementById("fx");
    const fctx = fx.getContext("2d");
    let px = 0, py = 0;

    function fitFx(){
      const rect = fx.getBoundingClientRect();
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      fx.width  = Math.round(rect.width * dpr);
      fx.height = Math.round(rect.height * dpr);
    }

    const parts = [];
    function seedParts(){
      parts.length = 0;
      const n = 110;
      for(let i=0;i<n;i++){
        parts.push({
          x: Math.random(),
          y: Math.random(),
          r: 0.6 + Math.random()*1.6,
          a: 0.10 + Math.random()*0.26,
          vx:(Math.random()-0.5)*0.0006,
          vy:(Math.random()-0.5)*0.0006
        });
      }
    }

    function drawFx(){
      const w = fx.width, h = fx.height;
      fctx.clearRect(0,0,w,h);

      // soft glow field
      const gx = w*(0.50 + px*0.06);
      const gy = h*(0.50 + py*0.06);
      const g = fctx.createRadialGradient(gx,gy, w*0.06, gx,gy, w*0.48);
      g.addColorStop(0, "rgba(165,240,255,0.12)");
      g.addColorStop(0.45, "rgba(183,168,255,0.07)");
      g.addColorStop(1, "rgba(0,0,0,0)");
      fctx.fillStyle = g;
      fctx.fillRect(0,0,w,h);

      // particles
      for(const p of parts){
        p.x += p.vx; p.y += p.vy;
        if (p.x<0) p.x=1; if (p.x>1) p.x=0;
        if (p.y<0) p.y=1; if (p.y>1) p.y=0;

        const x = p.x*w;
        const y = p.y*h;

        fctx.fillStyle = `rgba(238,243,255,${p.a})`;
        fctx.beginPath();
        fctx.arc(x,y,p.r*(window.devicePixelRatio||1),0,Math.PI*2);
        fctx.fill();
      }

      requestAnimationFrame(drawFx);
    }

    window.addEventListener("mousemove", (e)=>{
      const r = sphereWrap.getBoundingClientRect();
      const cx = r.left + r.width/2;
      const cy = r.top + r.height/2;
      px = clamp((e.clientX - cx)/(r.width/2), -1, 1);
      py = clamp((e.clientY - cy)/(r.height/2), -1, 1);
    });

    // ===== Init =====
    buildOptions();
    setActive(0, true);
    loadPreview(vibes[0]);
    applyRotation();

    fitFx();
    seedParts();
    drawFx();
    loop();

    window.addEventListener("resize", ()=>{
      fitFx();
      seedParts();
    });
  </script>
</body>
</html>
