<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Snack Packz — Spin Select</title>
  <meta name="theme-color" content="#070812"/>

  <style>
    :root{
      --txt:#EEF3FF;
      --mut:rgba(238,243,255,.72);
      --line:rgba(255,255,255,.12);

      --glassA:rgba(10,12,24,.40);
      --glassB:rgba(10,12,24,.22);

      --shadow: 0 26px 120px rgba(0,0,0,.66);
      --shadow2: 0 14px 70px rgba(0,0,0,.45);
      --r:22px;

      --accent:#A5F0FF;
      --accent2:#B7A8FF;

      --bg0:#030410;
      --bg1:#05071A;

      --hudW:min(36vw, 520px);
      --stageW:min(1200px, 100%);
      --globe:min(82vmin, 940px);
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--txt);
      background:
        radial-gradient(1400px 900px at 24% 10%, rgba(167,120,255,.26), transparent 62%),
        radial-gradient(1200px 900px at 78% 12%, rgba(72,220,255,.17), transparent 62%),
        radial-gradient(900px 700px at 50% 92%, rgba(120,255,209,.10), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow:hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
    }

    /* lightweight “stars” (no canvas lag) */
    body:before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      z-index:1;
      opacity:.55;
      background:
        radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.55), transparent 60%),
        radial-gradient(1px 1px at 20% 35%, rgba(255,255,255,.40), transparent 60%),
        radial-gradient(1px 1px at 35% 18%, rgba(255,255,255,.48), transparent 60%),
        radial-gradient(1px 1px at 46% 40%, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(1px 1px at 58% 22%, rgba(255,255,255,.42), transparent 60%),
        radial-gradient(1px 1px at 72% 34%, rgba(255,255,255,.38), transparent 60%),
        radial-gradient(1px 1px at 84% 18%, rgba(255,255,255,.46), transparent 60%),
        radial-gradient(1px 1px at 92% 44%, rgba(255,255,255,.30), transparent 60%),
        radial-gradient(1px 1px at 14% 62%, rgba(255,255,255,.30), transparent 60%),
        radial-gradient(1px 1px at 28% 74%, rgba(255,255,255,.42), transparent 60%),
        radial-gradient(1px 1px at 52% 78%, rgba(255,255,255,.30), transparent 60%),
        radial-gradient(1px 1px at 76% 72%, rgba(255,255,255,.40), transparent 60%),
        radial-gradient(1px 1px at 90% 84%, rgba(255,255,255,.28), transparent 60%);
      mix-blend-mode: screen;
      filter: blur(.2px);
    }

    a{color:inherit;text-decoration:none}
    button{font:inherit}
    button, a{-webkit-tap-highlight-color: transparent}

    /* ===== NAV ===== */
    .nav{
      position:fixed; left:0; right:0; top:0;
      z-index:90;
      padding: 14px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:14px;
      backdrop-filter: blur(16px) saturate(130%);
      -webkit-backdrop-filter: blur(16px) saturate(130%);
      background: linear-gradient(180deg, rgba(0,0,0,.60), rgba(0,0,0,.10));
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:0}
    .logo{
      width:40px;height:40px;border-radius:14px;
      background:
        radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,.38), transparent 60%),
        radial-gradient(18px 18px at 70% 65%, rgba(165,240,255,.22), transparent 65%),
        linear-gradient(135deg, rgba(165,240,255,.25), rgba(183,168,255,.20));
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 14px 34px rgba(0,0,0,.42);
      flex:0 0 auto;
    }
    .brandText h1{margin:0;font-size:15px;font-weight:950;letter-spacing:.5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .brandText p{margin:4px 0 0;font-size:12px;color:rgba(238,243,255,.70);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .navLinks{
      display:flex; gap:18px; align-items:center;
      color:rgba(238,243,255,.72); font-size:12px; letter-spacing:.2px;
    }
    .navLinks a{padding:8px 10px;border-radius:999px;transition:background .12s ease}
    .navLinks a:hover{background:rgba(255,255,255,.06)}
    @media (max-width:980px){ .navLinks{display:none} }

    .btn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: rgba(238,243,255,.92);
      border-radius:999px;
      padding: 9px 12px;
      font-size: 12px;
      letter-spacing:.2px;
      display:inline-flex; gap:8px; align-items:center;
      user-select:none;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      backdrop-filter: blur(12px) saturate(130%);
      -webkit-backdrop-filter: blur(12px) saturate(130%);
      cursor:pointer;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);background:rgba(0,0,0,.26);border-color:rgba(255,255,255,.18)}
    .btn:active{transform:translateY(0) scale(.99)}
    .dot{width:7px;height:7px;border-radius:50%;background:linear-gradient(180deg,var(--accent),var(--accent2));box-shadow:0 0 0 4px rgba(165,240,255,.10)}

    /* ===== GRID ===== */
    .scene{
      position:fixed;
      inset:0;
      padding-top:74px;
      z-index:10;
      display:grid;
      grid-template-columns: 1fr var(--hudW);
      gap: clamp(14px, 2.4vw, 26px);
      align-items:stretch;
    }
    @media (max-width:980px){
      body{overflow:auto}
      .scene{position:relative;grid-template-columns:1fr;padding-top:78px}
    }

    /* ===== HERO LEFT ===== */
    .left{padding:clamp(12px,2vw,18px);display:flex;align-items:center;justify-content:center}
    .hero{
      width:var(--stageW);
      min-height:74vh;
      border-radius:var(--r);
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.065), rgba(255,255,255,.018));
      backdrop-filter: blur(18px) saturate(140%);
      -webkit-backdrop-filter: blur(18px) saturate(140%);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-1px;
      background:
        radial-gradient(1200px 520px at 50% 14%, rgba(165,240,255,.18), transparent 62%),
        radial-gradient(1200px 840px at 60% 74%, rgba(183,168,255,.16), transparent 64%),
        radial-gradient(900px 700px at 42% 110%, rgba(120,255,209,.08), transparent 62%);
      opacity:.98;
      pointer-events:none;
    }

    .lines{
      position:absolute; inset:0;
      background:
        linear-gradient(rgba(255,255,255,.07), rgba(255,255,255,0)) 0 0/100% 140px,
        repeating-linear-gradient(90deg, rgba(255,255,255,.07) 0, rgba(255,255,255,.07) 1px, transparent 1px, transparent 150px) 0 0/100% 100%;
      opacity:.10;
      pointer-events:none;
      mask-image: radial-gradient(720px 380px at 50% 10%, rgba(0,0,0,1), rgba(0,0,0,0) 72%);
    }

    .heroInner{
      position:relative;
      z-index:3;
      height:100%;
      padding: clamp(18px, 2.4vw, 26px);
      display:grid;
      grid-template-rows: auto auto 1fr;
      gap: 12px;
    }

    .topPill{
      justify-self:center;
      display:inline-flex;
      align-items:center;
      gap:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      border-radius:999px;
      padding: 10px 14px;
      font-size: 12px;
      color: rgba(238,243,255,.80);
      backdrop-filter: blur(12px) saturate(130%);
      -webkit-backdrop-filter: blur(12px) saturate(130%);
      transition: opacity 220ms ease, transform 220ms ease, filter 220ms ease;
      box-shadow: 0 14px 50px rgba(0,0,0,.35);
    }

    .headline{
      justify-self:center;
      display:grid;
      justify-items:center;
      text-align:center;
      gap:10px;
      transition: opacity 220ms ease, transform 220ms ease, filter 220ms ease;
    }
    .headline h2{
      margin:0;
      font-size: clamp(34px, 4.9vw, 66px);
      line-height:1.01;
      font-weight:985;
      letter-spacing:-1.1px;
      text-shadow: 0 40px 120px rgba(0,0,0,.55);
      max-width: 22ch;
    }
    .headline p{
      margin:0;
      color: rgba(238,243,255,.76);
      font-size: 13px;
      line-height: 1.45;
      max-width: 72ch;
    }
    .ctaRow{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:8px}
    .ctaPrimary{padding:11px 14px;font-weight:950;border-color:rgba(165,240,255,.20);box-shadow: 0 18px 70px rgba(0,0,0,.40);}

    .stats{
      margin-top:auto;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
      max-width: 980px;
      width:100%;
      justify-self:center;
      transition: opacity 220ms ease, transform 220ms ease, filter 220ms ease;
      padding-bottom: 12px;
      z-index:3;
    }
    @media (max-width:920px){ .stats{grid-template-columns:1fr} }
    .stat{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      backdrop-filter: blur(14px) saturate(140%);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      padding: 14px 14px;
      box-shadow: 0 16px 70px rgba(0,0,0,.35);
    }
    .stat .n{font-size:26px;font-weight:980;letter-spacing:-.35px}
    .stat .t{margin-top:6px;font-size:12px;color:rgba(238,243,255,.72)}

    /* ===== CENTRE SCENE ===== */
    .centre{
      position:absolute;
      inset:0;
      z-index:2;
      pointer-events:none;
    }

    .beam{
      position:absolute;
      left:50%;
      top:-42%;
      transform: translateX(-50%);
      width: 18%;
      height: 195%;
      background: linear-gradient(180deg,
        rgba(165,240,255,0),
        rgba(165,240,255,.22),
        rgba(183,168,255,.18),
        rgba(0,0,0,0)
      );
      filter: blur(12px);
      opacity:.92;
    }

    .spin3d{
      position:absolute;
      left:50%;
      bottom: calc(-1 * (var(--globe) * 0.52));
      transform: translateX(-50%);
      width: var(--globe);
      height: var(--globe);
      perspective: 1200px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      pointer-events:auto;
      z-index:2;

      /* CRITICAL for mobile: stops the page fighting with drag */
      touch-action: none;
    }

    .orbit{
      position:absolute;
      inset:-12%;
      border-radius:50%;
      border:1px solid rgba(255,255,255,.12);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
      opacity:.90;
      z-index:1;
      pointer-events:none;
    }

    .globe{
      position:absolute; inset:0;
      border-radius:50%;
      z-index:2;
      cursor:pointer;
      border:1px solid rgba(255,255,255,.18);
      background:
        radial-gradient(circle at 34% 24%, rgba(255,255,255,.26), rgba(255,255,255,0) 34%),
        radial-gradient(circle at 62% 44%, rgba(165,240,255,.18), rgba(165,240,255,0) 50%),
        radial-gradient(circle at 50% 68%, rgba(183,168,255,.16), rgba(183,168,255,0) 56%),
        radial-gradient(circle at 50% 54%, rgba(0,0,0,.06), rgba(0,0,0,.78)),
        linear-gradient(180deg, rgba(255,255,255,.07), rgba(0,0,0,.42));
      box-shadow:
        0 70px 260px rgba(0,0,0,.74),
        inset 0 0 0 1px rgba(255,255,255,.08);
    }
    .globe:before{
      content:"";
      position:absolute;
      inset:-18%;
      border-radius:50%;
      background:
        radial-gradient(circle at 40% 42%, rgba(165,240,255,.22), transparent 62%),
        radial-gradient(circle at 60% 58%, rgba(183,168,255,.15), transparent 62%);
      filter: blur(18px);
      opacity:.92;
      mix-blend-mode: screen;
      pointer-events:none;
    }

    /* reveal button (mobile helper, also works on desktop) */
    .revealBtn{
      position:absolute;
      left:50%;
      top:50%;
      transform: translate(-50%,-50%);
      z-index:9;
      border-radius: 999px;
      padding: 10px 14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(14px) saturate(140%);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      color: rgba(238,243,255,.92);
      font-size: 12px;
      font-weight: 950;
      letter-spacing:.25px;
      display:flex; align-items:center; gap:10px;
      box-shadow: var(--shadow2);
      cursor:pointer;
      transition: opacity 180ms ease, transform 180ms ease, filter 180ms ease;
    }
    .revealBtn:hover{transform:translate(-50%,-51%)}
    .revealBtn:active{transform:translate(-50%,-50%) scale(.99)}
    .revealBtn .spark{
      width:18px;height:18px;border-radius:10px;
      background: linear-gradient(180deg, rgba(165,240,255,.92), rgba(183,168,255,.86));
      box-shadow: 0 0 0 7px rgba(165,240,255,.09);
      border:1px solid rgba(255,255,255,.14);
    }
    .hero.engaged .revealBtn{
      opacity:0;
      transform: translate(-50%,-48%);
      filter: blur(2px);
      pointer-events:none;
    }

    /* OPTIONS */
    .opts{
      position:absolute;
      inset:-28%;
      z-index:6;
      opacity:0;
      transform: scale(.988);
      transition: opacity 180ms ease, transform 180ms ease;
      transform-style: preserve-3d;
      pointer-events:auto;
    }
    .hero.engaged .opts{opacity:1;transform:scale(1)}

    .opt{
      position:absolute; left:50%; top:50%;
      height: 40px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(14px) saturate(140%);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      display:flex; align-items:center; gap:10px;
      padding: 0 12px;
      box-shadow: 0 18px 90px rgba(0,0,0,.58);
      cursor:pointer;
      white-space:nowrap;
      user-select:none;
      will-change: transform, opacity, filter;
      transform-style: preserve-3d;
    }
    .opt:hover{border-color:rgba(165,240,255,.34);background: rgba(0,0,0,.28)}
    .opt.active{border-color:rgba(165,240,255,.46);background: rgba(0,0,0,.30)}
    .oDot{width:10px;height:10px;border-radius:50%;background:linear-gradient(180deg,var(--accent),var(--accent2));box-shadow:0 0 0 7px rgba(165,240,255,.09)}
    .oTxt{font-weight:950;font-size:12px;letter-spacing:.62px;text-transform:uppercase}
    .oSub{margin-left:auto;font-size:11px;color:rgba(238,243,255,.68);letter-spacing:.22px;text-transform:uppercase}

    /* Engage: fade headline/stats/pill (only after reveal) */
    .hero.engaged .topPill,
    .hero.engaged .headline,
    .hero.engaged .stats{
      opacity:0;
      transform: translateY(-10px);
      filter: blur(3px);
      pointer-events:none;
    }

    /* ===== RIGHT PREVIEW ===== */
    .hud{
      padding: clamp(12px, 2vw, 16px);
      border-left:1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:stretch;
      z-index:20;
    }
    @media (max-width:980px){ .hud{border-left:none} }

    .hudCard{
      width:100%;
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(18px) saturate(140%);
      -webkit-backdrop-filter: blur(18px) saturate(140%);
      position:relative;
      min-height: 420px;
    }

    .hudMedia{position:absolute;inset:0;z-index:2}
    .hudMedia img,.hudMedia video{
      position:absolute;inset:0;width:100%;height:100%;
      object-fit:cover;
      transform: scale(1.02);
      filter: contrast(1.10) saturate(1.06) brightness(1.02);
    }
    .hudMedia img{opacity:1;transition:opacity 220ms ease}
    .hudMedia video{opacity:0;transition:opacity 320ms ease}
    .hudMedia.ready video{opacity:1}
    .hudMedia.ready img{opacity:0}

    .hudShade{
      position:absolute;inset:0;z-index:3;
      background:
        radial-gradient(700px 380px at 20% 10%, rgba(0,0,0,.10), transparent 60%),
        radial-gradient(800px 520px at 70% 35%, rgba(0,0,0,.26), transparent 65%),
        linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.76));
      pointer-events:none;
    }
    .hudTop{
      position:relative;z-index:5;
      padding:16px 16px 0;
      display:flex;justify-content:space-between;gap:12px;align-items:flex-start;
    }
    .hudTitle h3{margin:0;font-size:18px;font-weight:950;letter-spacing:.55px;text-shadow:0 18px 60px rgba(0,0,0,.70)}
    .hudTitle p{margin:6px 0 0;font-size:12.5px;color:rgba(238,243,255,.80);line-height:1.35;max-width:46ch;text-shadow:0 18px 60px rgba(0,0,0,.70)}
    .enter{
      border-radius: 16px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.20);
      background: rgba(0,0,0,.24);
      backdrop-filter: blur(14px) saturate(140%);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      font-size: 12px;
      font-weight: 950;
      letter-spacing:.25px;
      display:inline-flex;align-items:center;gap:10px;
      cursor:pointer;white-space:nowrap;
      box-shadow: 0 18px 70px rgba(0,0,0,.45);
    }
    .enter .spark{
      width:18px;height:18px;border-radius:10px;
      background: linear-gradient(180deg, rgba(165,240,255,.92), rgba(183,168,255,.86));
      box-shadow: 0 0 0 7px rgba(165,240,255,.09);
      border:1px solid rgba(255,255,255,.14);
    }
    .hudBottom{
      position:absolute;left:0;right:0;bottom:0;z-index:6;
      padding:14px 16px 16px;
      display:flex;justify-content:space-between;gap:12px;align-items:flex-end;
    }
    .hudStat{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      border-radius: 16px;
      padding: 10px 12px;
      max-width: 62%;
      backdrop-filter: blur(14px) saturate(140%);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      box-shadow: 0 16px 70px rgba(0,0,0,.35);
    }
    .hudStat .k{font-size:11px;color:rgba(238,243,255,.72)}
    .hudStat .v{margin-top:5px;font-size:12.5px;font-weight:950}
    .hudTip{text-align:right;font-size:11px;color:rgba(238,243,255,.72);line-height:1.25;text-shadow:0 18px 60px rgba(0,0,0,.70)}
  </style>
</head>

<body>
  <div class="nav">
    <div class="brand">
      <div class="logo"></div>
      <div class="brandText">
        <h1>Snack Packz</h1>
        <p>Spin the wheel. Pick your vibe. Order fast.</p>
      </div>
    </div>

    <div class="navLinks">
      <a href="#" onclick="return false;">About</a>
      <a href="#" onclick="return false;">Services</a>
      <a href="#" onclick="return false;">Pricing</a>
      <a href="#" onclick="return false;">Resources</a>
      <a href="#" onclick="return false;">Blog</a>
    </div>

    <div style="display:flex; gap:10px; align-items:center;">
      <div class="btn"><span class="dot"></span> Drag • Scroll • Snap</div>
      <a class="btn" id="waTop" href="#" rel="noopener">WhatsApp</a>
    </div>
  </div>

  <div class="scene">
    <!-- LEFT -->
    <div class="left">
      <div class="hero" id="hero">
        <div class="lines" aria-hidden="true"></div>

        <div class="heroInner">
          <div class="topPill"><span class="dot"></span> Web3-level hero layout • but it’s Snack Packz</div>

          <div class="headline">
            <h2>Redefining Snack Packs with a 3D Spin Selector</h2>
            <p>Reveal the vibes. Spin fast. Preview loads clean (image → video). Enter to order.</p>
            <div class="ctaRow">
              <a class="btn ctaPrimary" href="#" onclick="document.getElementById('spin3d').scrollIntoView({behavior:'smooth'}); return false;">Discover more</a>
              <a class="btn" id="waCta" href="#" rel="noopener">Order on WhatsApp</a>
            </div>
          </div>

          <div class="stats">
            <div class="stat"><div class="n">500+</div><div class="t">Snack Packs delivered successfully</div></div>
            <div class="stat"><div class="n">240+</div><div class="t">Customers who found their vibe</div></div>
            <div class="stat"><div class="n">98%</div><div class="t">Repeat order satisfaction rate</div></div>
          </div>
        </div>

        <div class="centre">
          <div class="beam" aria-hidden="true"></div>

          <div class="spin3d" id="spin3d">
            <div class="orbit" aria-hidden="true"></div>

            <div class="globe" id="globe" role="button" aria-label="Reveal vibes"></div>

            <button class="revealBtn" id="revealBtn" type="button">
              <span class="spark" aria-hidden="true"></span>
              Reveal vibes
            </button>

            <div class="opts" id="opts" aria-label="Vibe options"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="hud">
      <div class="hudCard">
        <div class="hudMedia" id="hudMedia" aria-hidden="true">
          <img id="hudImg" src="assets/gym.jpg" alt=""/>
          <video id="hudVid" muted playsinline loop preload="metadata"></video>
        </div>
        <div class="hudShade" aria-hidden="true"></div>

        <div class="hudTop">
          <div class="hudTitle">
            <h3 id="hudTitle">GYM</h3>
            <p id="hudDesc">High focus. Clean fuel. No distractions.</p>
          </div>
          <a class="enter" id="enterBtn" href="gym.html">
            <span class="spark" aria-hidden="true"></span>
            Enter
          </a>
        </div>

        <div class="hudBottom">
          <div class="hudStat">
            <div class="k">Preview</div>
            <div class="v" id="hudMeta">Image → Video</div>
          </div>
          <div class="hudTip">
            Tap “Reveal vibes”<br/>Drag to spin • Scroll to flick<br/>Tap vibe twice to enter
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const WHATSAPP_NUMBER = "447483849357";

    const vibes = [
      { key:"gym",     label:"GYM",     sub:"FOCUS", page:"gym.html",     img:"assets/gym.jpg",     vid:"assets/gym.mp4",     desc:"High focus. Clean fuel. No distractions." },
      { key:"lockin",  label:"LOCK-IN", sub:"GRIND", page:"lock-in.html", img:"assets/lockin.jpg",  vid:"assets/lockin.mp4",  desc:"Tunnel vision mode. Phone down. Get it done." },
      { key:"work",    label:"WORK",    sub:"DAY",   page:"work.html",    img:"assets/work.jpg",    vid:"assets/work.mp4",    desc:"Clean energy. Smooth day. No crash." },
      { key:"gaming",  label:"GAMING",  sub:"NIGHT", page:"gaming.html",  img:"assets/gaming.jpg",  vid:"assets/gaming.mp4",  desc:"Locked in. Fast hands. Zero tilt." },
      { key:"mystery", label:"MYSTERY", sub:"DROP",  page:"mystery.html", img:"assets/mystery.jpg", vid:"assets/mystery.mp4", desc:"Random pull. Premium chaos (in a good way)." },
      { key:"fresh",   label:"FRESH",   sub:"CLEAN", page:"fresh.html",   img:"assets/fresh.jpg",   vid:"assets/fresh.mp4",   desc:"Light, clean, refreshing. Reset the day." },
    ];

    const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));
    const wa = (text)=>`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(text)}`;
    document.getElementById("waTop").href = wa("Hi Snack Packz — I want to place an order.");
    document.getElementById("waCta").href = wa("Hi Snack Packz — I want to place an order.");

    const hero    = document.getElementById("hero");
    const spin3d  = document.getElementById("spin3d");
    const globe   = document.getElementById("globe");
    const optsEl  = document.getElementById("opts");
    const revealBtn = document.getElementById("revealBtn");

    const hudMedia = document.getElementById("hudMedia");
    const hudImg   = document.getElementById("hudImg");
    const hudVid   = document.getElementById("hudVid");
    const hudTitle = document.getElementById("hudTitle");
    const hudDesc  = document.getElementById("hudDesc");
    const hudMeta  = document.getElementById("hudMeta");
    const enterBtn = document.getElementById("enterBtn");

    /* Premium preview: image instantly → video fades when ready */
    let videoToken = 0;
    function loadPreview(v){
      hudTitle.textContent = v.label;
      hudDesc.textContent  = v.desc;
      enterBtn.href = v.page;

      hudMedia.classList.remove("ready");
      hudMeta.textContent = "Image → Video";
      hudImg.src = v.img;

      const t = ++videoToken;
      try{ hudVid.pause(); }catch(e){}
      hudVid.removeAttribute("src");
      hudVid.load();
      hudVid.src = v.vid;

      const onReady = ()=>{
        if (t !== videoToken) return;
        hudMedia.classList.add("ready");
        hudMeta.textContent = "Video ready";
        try{ hudVid.play().catch(()=>{}); }catch(e){}
      };
      const onErr = ()=>{
        if (t !== videoToken) return;
        hudMedia.classList.remove("ready");
        hudMeta.textContent = "Video unavailable (image only)";
      };

      hudVid.addEventListener("loadeddata", onReady, {once:true});
      hudVid.addEventListener("canplaythrough", onReady, {once:true});
      hudVid.addEventListener("error", onErr, {once:true});
      hudVid.load();
    }

    /* Build options */
    const N = vibes.length;
    const step = 360 / N;
    const normDeg = d => ((d%360)+360)%360;
    let activeIndex = 0;

    function buildOptions(){
      optsEl.innerHTML = "";
      for(let i=0;i<N;i++){
        const opt = document.createElement("div");
        opt.className = "opt";
        opt.dataset.index = String(i);
        opt.style.width = (vibes[i].label.length > 6 ? 178 : 156) + "px";
        opt.innerHTML = `
          <span class="oDot" aria-hidden="true"></span>
          <span class="oTxt">${vibes[i].label}</span>
          <span class="oSub">${vibes[i].sub}</span>
        `;

        opt.addEventListener("mouseenter", ()=>{
          // hover preview only if revealed (prevents random changes)
          if (!hero.classList.contains("engaged")) return;
          if (window.matchMedia("(hover:hover)").matches) setActive(i, false);
        });

        opt.addEventListener("click", (e)=>{
          e.preventDefault();
          if (!hero.classList.contains("engaged")) setEngaged(true);

          const idx = Number(opt.dataset.index);

          // mobile: tap once preview, second tap enter
          if (window.matchMedia("(hover:none)").matches){
            if (activeIndex === idx && opt.classList.contains("active")){
              window.location.href = vibes[idx].page;
              return;
            }
            setActive(idx, true);
            return;
          }

          setActive(idx, true);
        });

        optsEl.appendChild(opt);
      }
      updateActiveClass();
    }

    function updateActiveClass(){
      optsEl.querySelectorAll(".opt").forEach(el=>el.classList.remove("active"));
      const el = optsEl.querySelector(`.opt[data-index="${activeIndex}"]`);
      if (el) el.classList.add("active");
    }

    function nearestIndex(rot){
      const r = normDeg(rot);
      let i = Math.round((-r) / step);
      i = ((i%N)+N)%N;
      return i;
    }

    /* Spin engine (stable) */
    let rot = 0;
    let vel = 0;
    let dragging = false;
    let pointerId = null;

    function snapToIndex(i){
      const target = -i * step;
      let diff = target - rot;
      diff = ((diff + 540) % 360) - 180;
      rot += diff;
      vel = 0;
    }

    function setActive(i, snap=true){
      activeIndex = i;
      updateActiveClass();
      loadPreview(vibes[i]);
      if (snap) snapToIndex(i);
    }

    function layout3D(){
      if (!hero.classList.contains("engaged")) return; // no layout spam when hidden

      const rect = spin3d.getBoundingClientRect();
      const base = Math.min(rect.width, rect.height);

      const radius = base * 0.62;
      const depth  = base * 0.22;

      const items = optsEl.querySelectorAll(".opt");
      for(let i=0;i<items.length;i++){
        const a = ((i*step) + rot) * Math.PI/180;

        const x = Math.cos(a) * radius;
        const y = Math.sin(a) * radius * 0.60;
        const z = (Math.cos(a) * depth);

        const z01 = (z/depth + 1)/2;
        const scale = 0.92 + z01*0.24;
        const alpha = 0.62 + z01*0.38;
        const blur  = (1 - z01) * 0.36;

        items[i].style.transform =
          `translate3d(calc(-50% + ${x}px), calc(-50% + ${y}px), ${z}px) scale(${scale})`;
        items[i].style.opacity = alpha.toFixed(3);
        items[i].style.filter  = `blur(${blur.toFixed(2)}px)`;
        items[i].style.zIndex  = String(10 + Math.round(z01*90));
      }
    }

    function onWheel(e){
      if (!hero.classList.contains("engaged")) return;
      e.preventDefault();

      const delta = e.deltaY || 0;
      const add = clamp(delta * 0.18, -42, 42);
      rot += add;
      vel += add * 6.5;

      const idx = nearestIndex(rot);
      if (idx !== activeIndex){
        activeIndex = idx;
        updateActiveClass();
        loadPreview(vibes[idx]);
      }

      clearTimeout(onWheel._t);
      onWheel._t = setTimeout(()=> setActive(nearestIndex(rot), true), 120);
    }

    function angleFromEvent(e){
      const r = spin3d.getBoundingClientRect();
      const cx = r.left + r.width/2;
      const cy = r.top + r.height/2;
      const dx = e.clientX - cx;
      const dy = e.clientY - cy;
      return Math.atan2(dy, dx) * 180 / Math.PI;
    }

    let lastAng = 0;
    let lastT = 0;

    function onDown(e){
      if (!hero.classList.contains("engaged")) setEngaged(true);

      dragging = true;
      pointerId = e.pointerId;
      spin3d.setPointerCapture?.(pointerId);

      lastAng = angleFromEvent(e);
      lastT = performance.now();
    }

    function onMove(e){
      if (!dragging || e.pointerId !== pointerId) return;

      const a = angleFromEvent(e);
      let da = a - lastAng;
      if (da > 180) da -= 360;
      if (da < -180) da += 360;

      rot += da;

      const now = performance.now();
      const dt = Math.max(1, (now - lastT)) / 1000;
      const v = da / dt;
      vel = vel*0.78 + v*0.22;

      lastAng = a;
      lastT = now;

      const idx = nearestIndex(rot);
      if (idx !== activeIndex){
        activeIndex = idx;
        updateActiveClass();
        loadPreview(vibes[idx]);
      }
    }

    function onUp(e){
      if (!dragging || e.pointerId !== pointerId) return;
      dragging = false;
      pointerId = null;
      setTimeout(()=> setActive(nearestIndex(rot), true), 60);
    }

    /* Reveal behaviour (robust) */
    function setEngaged(on){
      hero.classList.toggle("engaged", on);
      if (on){
        // force immediate correct layout when revealed
        requestAnimationFrame(layout3D);
      }
    }

    // Desktop: hover OR click works
    spin3d.addEventListener("mouseenter", ()=>{
      if (window.matchMedia("(hover:hover)").matches) setEngaged(true);
    });

    // Click/tap to reveal
    globe.addEventListener("click", ()=> setEngaged(true));
    revealBtn.addEventListener("click", ()=> setEngaged(true));

    // Drag + scroll
    spin3d.addEventListener("pointerdown", onDown, {passive:true});
    spin3d.addEventListener("pointermove", onMove, {passive:true});
    spin3d.addEventListener("pointerup", onUp, {passive:true});
    spin3d.addEventListener("pointercancel", onUp, {passive:true});
    spin3d.addEventListener("wheel", onWheel, {passive:false});

    /* Main loop (only animates when revealed) */
    let last = performance.now();
    function loop(now){
      const dt = Math.min(0.05, (now-last)/1000);
      last = now;

      if (hero.classList.contains("engaged") && !dragging){
        rot += vel * dt;
        vel *= Math.exp(-3.1 * dt);

        if (Math.abs(vel) < 18){
          const idx = nearestIndex(rot);
          const target = -idx * step;
          let diff = target - rot;
          diff = ((diff + 540) % 360) - 180;
          rot += diff * Math.min(1, dt*9);

          if (idx !== activeIndex){
            activeIndex = idx;
            updateActiveClass();
            loadPreview(vibes[idx]);
          }
        }
        layout3D();
      }

      requestAnimationFrame(loop);
    }

    /* Init */
    buildOptions();
    setActive(0, true);
    loadPreview(vibes[0]);

    // Don’t auto-engage (stops “random movement” on load), but do layout once ready
    requestAnimationFrame(()=>{ /* nothing */ });
    requestAnimationFrame(loop);

    window.addEventListener("resize", ()=>{
      if (hero.classList.contains("engaged")) requestAnimationFrame(layout3D);
    });
  </script>
</body>
</html>
